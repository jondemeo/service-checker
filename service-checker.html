
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Service Area Checker</title>
</head>
<body style="font-family: sans-serif; text-align: center; max-width: 400px; margin: auto;">

<h2>Check if You’re in Our Service Area</h2>

<input type="text" id="address" placeholder="Enter your address" style="width: 100%; padding: 8px; margin-bottom: 8px;" autocomplete="off">
<button id="check-btn" style="padding: 8px 16px;">Check</button>
<p id="result" style="margin-top: 12px; font-weight: bold;"></p>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAGIKItr6fYXFCP46NqKArqnhp5VXBynDc&libraries=places"></script>
<script>
const serviceCenter = { lat: 40.17396, lng: -80.24617 }; // Washington, PA
const radiusMiles = 60;
let selectedLocation = null;

function initAutocomplete() {
  const input = document.getElementById("address");
  const autocomplete = new google.maps.places.Autocomplete(input, { types: ["address"] });
  autocomplete.setFields(['geometry']);
  autocomplete.addListener("place_changed", () => {
    const place = autocomplete.getPlace();
    if (!place.geometry) {
      document.getElementById("result").textContent = "Please select a full address from the suggestions.";
      selectedLocation = null;
      return;
    }
    selectedLocation = {
      lat: place.geometry.location.lat(),
      lng: place.geometry.location.lng()
    };
    document.getElementById("result").textContent = "";
  });
}

document.addEventListener("DOMContentLoaded", () => {
  initAutocomplete();

  document.getElementById("check-btn").addEventListener("click", () => {
    const result = document.getElementById("result");

    if (!selectedLocation) {
      result.textContent = "Please enter and select a full address from the suggestions.";
      return;
    }

    const distance = getDistanceFromLatLonInMiles(
      serviceCenter.lat, serviceCenter.lng,
      selectedLocation.lat, selectedLocation.lng
    );

    if (distance <= radiusMiles) {
      result.textContent = `✅ You’re in our service area! (${distance.toFixed(1)} miles away)`;
    } else {
      result.textContent = `⚠️ You might be slightly outside our regular service area (${distance.toFixed(1)} miles away), but contact us to inquire about service.`;
    }
  });
});

function getDistanceFromLatLonInMiles(lat1, lon1, lat2, lon2) {
  const R = 3958.8;
  const dLat = deg2rad(lat2-lat1);
  const dLon = deg2rad(lon2-lon1);
  const a =
    Math.sin(dLat/2) * Math.sin(dLat/2) +
    Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *
    Math.sin(dLon/2) * Math.sin(dLon/2);
  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
  return R * c;
}

function deg2rad(deg) {
  return deg * (Math.PI/180);
}
</script>

</body>
</html>
